// è¯Šæ–­å®éªŒä»£ç  - ç”¨äºå®šä½å†…å­˜æº¢å‡ºé—®é¢˜
// ä½¿ç”¨æ–¹æ³•ï¼šä¸´æ—¶æ›¿æ¢ handleSend å‡½æ•°ä¸­çš„ç›¸å…³ä»£ç 

// ============================================
// å®éªŒ Aï¼šä¸è°ƒç”¨ AIï¼Œè¿”å›å›ºå®šå°å›å¤
// ============================================
const handleSend_EXPERIMENT_A = async () => {
  if (inputText.trim() === '') return;
  
  const messageText = inputText.trim();
  const userMessage: ChatMessage = {
    id: Date.now().toString(),
    text: messageText,
    isUser: true,
    timestamp: new Date(),
  };
  
  setMessages((prev) => {
    const newMessages = [...prev, userMessage];
    return newMessages.length > MAX_MESSAGES_IN_MEMORY
      ? newMessages.slice(-MAX_MESSAGES_IN_MEMORY)
      : newMessages;
  });
  setInputText('');
  
  // ğŸ”´ å®éªŒAï¼šä¸è°ƒç”¨AIï¼Œç›´æ¥è¿”å›å›ºå®šå°å›å¤
  const fakeResponse: ChatMessage = {
    id: Date.now().toString() + '-bot',
    text: 'ok', // å›ºå®šå°å›å¤
    isUser: false,
    timestamp: new Date(),
  };
  
  setMessages((prev) => {
    const newMessages = [...prev, fakeResponse];
    return newMessages.length > MAX_MESSAGES_IN_MEMORY
      ? newMessages.slice(-MAX_MESSAGES_IN_MEMORY)
      : newMessages;
  });
  
  // å¦‚æœè¿™æ ·ä¸é—ªé€€ï¼Œé—®é¢˜åœ¨ AI è¯·æ±‚/å“åº”å¤„ç†
  // å¦‚æœä»ç„¶é—ªé€€ï¼Œé—®é¢˜åœ¨ UI ç»„ä»¶/æ¸²æŸ“é“¾
};

// ============================================
// å®éªŒ Bï¼šè°ƒç”¨ AIï¼Œä½†ä¸æ¸²æŸ“ç»“æœ
// ============================================
const handleSend_EXPERIMENT_B = async () => {
  if (inputText.trim() === '') return;
  
  const messageText = inputText.trim();
  const userMessage: ChatMessage = {
    id: Date.now().toString(),
    text: messageText,
    isUser: true,
    timestamp: new Date(),
  };
  
  setMessages((prev) => {
    const newMessages = [...prev, userMessage];
    return newMessages.length > MAX_MESSAGES_IN_MEMORY
      ? newMessages.slice(-MAX_MESSAGES_IN_MEMORY)
      : newMessages;
  });
  setInputText('');
  
  // è°ƒç”¨AIæœåŠ¡
  try {
    const { getAIResponse } = await import('@/services/chatService');
    const aiResponse = await getAIResponse(messageText, id || '');
    
    // ğŸ”´ å®éªŒBï¼šåªæ‰“å°ï¼Œä¸setStateï¼Œä¸æ¸²æŸ“
    console.log('[å®éªŒB] AIå›å¤æˆåŠŸï¼Œé•¿åº¦:', aiResponse.length);
    console.log('[å®éªŒB] done'); // åªæ‰“å°è¿™ä¸ªï¼Œä¸æ›´æ–°UI
    
    // å¦‚æœè¿™æ ·ä¸é—ªé€€ï¼Œé—®é¢˜åœ¨ setState + æ¸²æŸ“
    // å¦‚æœä»ç„¶é—ªé€€ï¼Œé—®é¢˜åœ¨ å“åº”è¯»å–/è§£æ
  } catch (error) {
    console.error('[å®éªŒB] è·å–AIå›å¤å¤±è´¥:', error);
  }
};



